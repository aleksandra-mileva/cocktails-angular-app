@if (isLoading) {
  <app-loader/>
} @else {
  <div class="details-container">

    <!-- Row 1: Title + Meta Info | Characteristics -->
    <div class="row row-1">

      <!-- Row 1 Column 1: Name and Action Row -->
      <div class="column left">
        <h2>{{ cocktail?.name }}</h2>
        <div class="actions-row">
          <span class="author">Author: {{ cocktail?.author }}</span>
          @if (isLoggedIn) {
            <span class="divider">|</span>
            <button mat-button color="accent" class="favorite-btn">
              <mat-icon>{{ cocktail?.favorite ? 'star' : 'star_border' }}</mat-icon>
              {{ cocktail?.favorite ? 'Unfavorite' : 'Favorite' }}
            </button>
          }

          @if (cocktail?.canDelete) {
            <span class="divider">|</span>
          }
          @if (cocktail?.canDelete) {
            <button mat-button color="warn" class="delete-btn" (click)="openDeleteModal()">
              <mat-icon>delete</mat-icon>
              Delete
            </button>
          }

          @if (showConfirmModal) {
            <app-confirmation-modal
              title="Delete Offer"
              message="Are you sure you want to delete this offer?"
              (confirmed)="deleteCocktail()"
              (cancelled)="handleCancel()"
              (closed)="handleCancel()"
            />
          }

          @if (cocktail?.canDelete) {
            <span class="divider">|</span>
          }
          @if (cocktail?.canDelete) {
            <button mat-button color="primary" class="edit-btn" (click)="goToEdit(cocktail)">
              <mat-icon>edit</mat-icon>
              Edit
            </button>
          }
        </div>
      </div>

      <!-- Row 1 Column 2: Characteristics (inline) -->
      <div class="column right">
        <h2 class="section-title">Characteristics</h2>
        <div class="characteristics-inline">
          <span>Alcohol: {{ cocktail?.spirit === 'NONE' ? 'Без алкохол' : cocktail?.spirit }}</span>
          <span class="divider">|</span>
          <span>Flavour: {{ cocktail?.flavour?.toLowerCase() | titlecase }}</span>
          <span class="divider">|</span>
          <span>Percent Alcohol: {{ cocktail?.percentAlcohol }}%</span>
          <span class="divider">|</span>
          <span>Servings: {{ cocktail?.servings }}</span>
        </div>
      </div>

    </div>
    <!-- EO Row 1: Title + Meta Info | Characteristics -->

    <!-- Row 2: Image | YouTube Video -->
    <div class="row row-2">
      <div class="column left">
        <img [src]="cocktail?.pictureUrl" alt="{{ cocktail?.name }}" class="main-image mat-elevation-z4"/>
      </div>
      <div class="column right mat-elevation-z4">
        <iframe
          width="100%"
          height="100%"
          [src]="'https://www.youtube.com/embed/' + cocktail?.videoId | safeUrl"
          frameborder="0"
          allowfullscreen>
        </iframe>
      </div>
    </div>

    <!-- Row 3: Ingredients | Preparation -->
    <div class="row row-3">
      <div class="column left white-card mat-elevation-z4">
        <h4 class="section-title">Ingredients</h4>
        <ul>
          @for (ing of cocktail?.ingredients; track $index) {
            <li>{{ ing }}</li>
          }
        </ul>
      </div>
      <div class="column right white-card mat-elevation-z4">
        <h4 class="section-title">Preparation</h4>
        <p>{{ cocktail?.preparation }}</p>
      </div>
    </div>


    <!-- Row 4: Comments -->
    <div class="row-4">
      <app-comments-list [cocktailId]="cocktailId"/>
    </div>

  </div>
}
